{% extends "portal/base.html" %}

{% block title %}Exploitation - RedEye C2 Framework{% endblock %}

{% block content %}
<section class="p-6">
    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-4xl font-bold text-cyber-red mb-2">Exploitation Dashboard</h1>
        <p class="text-gray-400">Active exploitation campaigns and results</p>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
        <div class="bg-cyber-dark/50 border border-cyber-red/20 rounded-lg p-4">
            <div class="text-cyber-red text-sm mb-1">Success Rate</div>
            <div class="text-2xl font-bold">78%</div>
        </div>
        <div class="bg-cyber-dark/50 border border-cyber-red/20 rounded-lg p-4">
            <div class="text-cyber-red text-sm mb-1">Active Campaigns</div>
            <div class="text-2xl font-bold">12</div>
        </div>
        <div class="bg-cyber-dark/50 border border-cyber-red/20 rounded-lg p-4">
            <div class="text-cyber-red text-sm mb-1">Compromised Systems</div>
            <div class="text-2xl font-bold">34</div>
        </div>
        <div class="bg-cyber-dark/50 border border-cyber-red/20 rounded-lg p-4">
            <div class="text-cyber-red text-sm mb-1">Active Shells</div>
            <div class="text-2xl font-bold">15</div>
        </div>
    </div>

    <!-- Exploitation Results -->
    {% for campaign in [
        {
            "id": "EXP-001",
            "name": "Operation BlackHawk",
            "timestamp": "2024-03-20 14:30",
            "operator": "exploit",
            "data": {
                "target_systems": [
                    {"ip": "192.168.1.100", "os": "Windows Server 2019", "status": "Compromised"},
                    {"ip": "192.168.1.101", "os": "Ubuntu 20.04", "status": "Compromised"},
                    {"ip": "192.168.1.102", "os": "Windows 10", "status": "In Progress"}
                ],
                "exploits_used": [
                    {"name": "EternalBlue", "cve": "CVE-2017-0144", "success_rate": "75%", "status": "Active"},
                    {"name": "BlueKeep", "cve": "CVE-2019-0708", "success_rate": "90%", "status": "Active"},
                    {"name": "Log4Shell", "cve": "CVE-2021-44228", "success_rate": "85%", "status": "Active"}
                ],
                "active_shells": [
                    {"type": "Meterpreter", "ip": "192.168.1.100", "uptime": "2h 15m"},
                    {"type": "Reverse Shell", "ip": "192.168.1.101", "uptime": "1h 45m"}
                ]
            }
        },
        {
            "id": "EXP-002",
            "name": "Operation RedStorm",
            "timestamp": "2024-03-20 16:45",
            "operator": "exploit",
            "data": {
                "target_systems": [
                    {"ip": "192.168.2.100", "os": "Debian 11", "status": "Compromised"},
                    {"ip": "192.168.2.101", "os": "CentOS 8", "status": "Failed"},
                    {"ip": "192.168.2.102", "os": "Windows Server 2022", "status": "In Progress"}
                ],
                "exploits_used": [
                    {"name": "ProxyShell", "cve": "CVE-2021-34473", "success_rate": "80%", "status": "Active"},
                    {"name": "PrintNightmare", "cve": "CVE-2021-34527", "success_rate": "70%", "status": "Active"}
                ],
                "active_shells": [
                    {"type": "Reverse Shell", "ip": "192.168.2.100", "uptime": "45m"}
                ]
            }
        }
    ] %}
    <div class="bg-cyber-dark/50 border border-cyber-red/20 rounded-lg mb-6 overflow-hidden">
        <!-- Campaign Header -->
        <div class="p-4 border-b border-cyber-red/20 flex justify-between items-center">
            <div>
                <span class="text-cyber-red font-mono">{{ campaign.id }}</span>
                <span class="text-xl text-cyber-blue ml-4">{{ campaign.name }}</span>
                <span class="text-gray-400 text-sm ml-4">{{ campaign.timestamp }}</span>
                <span class="bg-cyber-red/20 text-cyber-red px-2 py-1 rounded text-sm ml-4">{{ campaign.operator }}</span>
            </div>
            <button class="text-cyber-red hover:bg-cyber-red/20 p-2 rounded transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </button>
        </div>

        <!-- Campaign Content -->
        <div class="p-4">
            <!-- Target Systems -->
            <div class="mb-6">
                <h3 class="text-lg font-bold text-cyber-red mb-3">Target Systems</h3>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="text-left">
                            <tr class="border-b border-cyber-red/20">
                                <th class="p-2">IP Address</th>
                                <th class="p-2">Operating System</th>
                                <th class="p-2">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for system in campaign.data.target_systems %}
                            <tr class="border-b border-cyber-red/10 hover:bg-cyber-red/5">
                                <td class="p-2 font-mono">{{ system.ip }}</td>
                                <td class="p-2">{{ system.os }}</td>
                                <td class="p-2">
                                    <span class="px-2 py-1 rounded text-xs 
                                        {% if system.status == 'Compromised' %}bg-green-500/20 text-green-500
                                        {% elif system.status == 'Failed' %}bg-red-500/20 text-red-500
                                        {% else %}bg-yellow-500/20 text-yellow-500{% endif %}">
                                        {{ system.status }}
                                    </span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Exploits Used -->
            <div class="mb-6">
                <h3 class="text-lg font-bold text-cyber-red mb-3">Exploits Used</h3>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="text-left">
                            <tr class="border-b border-cyber-red/20">
                                <th class="p-2">Exploit Name</th>
                                <th class="p-2">CVE</th>
                                <th class="p-2">Success Rate</th>
                                <th class="p-2">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for exploit in campaign.data.exploits_used %}
                            <tr class="border-b border-cyber-red/10 hover:bg-cyber-red/5">
                                <td class="p-2">{{ exploit.name }}</td>
                                <td class="p-2 font-mono">{{ exploit.cve }}</td>
                                <td class="p-2">{{ exploit.success_rate }}</td>
                                <td class="p-2">
                                    <span class="px-2 py-1 rounded text-xs bg-green-500/20 text-green-500">
                                        {{ exploit.status }}
                                    </span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Active Shells -->
            <div>
                <h3 class="text-lg font-bold text-cyber-red mb-3">Active Shells</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    {% for shell in campaign.data.active_shells %}
                    <div class="bg-cyber-dark/30 p-4 rounded-lg border border-cyber-red/20">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-cyber-blue">{{ shell.type }}</span>
                            <span class="text-xs bg-green-500/20 text-green-500 px-2 py-1 rounded">ACTIVE</span>
                        </div>
                        <div class="font-mono text-sm mb-1">{{ shell.ip }}</div>
                        <div class="text-xs text-gray-400">Uptime: {{ shell.uptime }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</section>
{% endblock %}